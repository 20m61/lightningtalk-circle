import{r as o,j as e,a as d}from"./auth-Cj71Dr4d.js";import{M as I,B as c}from"./Modal-Bw8EuVDU.js";const M=({isOpen:v,onClose:u,onSuccess:l})=>{const[t,g]=o.useState("signin"),[x,m]=o.useState(!1),[r,h]=o.useState({email:"",password:"",fullName:"",confirmPassword:"",verificationCode:""}),[y,p]=o.useState("form"),[f,a]=o.useState(""),n=i=>{h(s=>({...s,[i.target.name]:i.target.value})),f&&a("")},w=async i=>{i.preventDefault(),m(!0),a("");try{if(t==="signup"){if(r.password!==r.confirmPassword){a("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“");return}const s=await d.signUp(r.email,r.password,r.fullName);s.success?p("verify"):a(s.error||"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}else{const s=await d.signIn(r.email,r.password);s.success?(l==null||l(s.user),u()):a(s.error||"ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ")}}catch{a("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚")}finally{m(!1)}},N=async i=>{i.preventDefault(),m(!0),a("");try{const s=await d.confirmSignUp(r.email,r.verificationCode);if(s.success){const j=await d.signIn(r.email,r.password);j.success?(l==null||l(j.user),u()):(g("signin"),p("form"),a("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚"))}else a(s.error||"ç¢ºèªã‚³ãƒ¼ãƒ‰ãŒç„¡åŠ¹ã§ã™")}catch{a("ç¢ºèªã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚")}finally{m(!1)}},b=i=>{try{i==="google"?d.googleSignIn():i==="apple"&&a("Apple Sign-Inã¯ç¾åœ¨æº–å‚™ä¸­ã§ã™")}catch{a("ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}},C=()=>{h({email:"",password:"",fullName:"",confirmPassword:"",verificationCode:""}),p("form"),a("")},k=()=>{g(t==="signin"?"signup":"signin"),C()};return e.jsx(I,{isOpen:v,onClose:u,title:y==="verify"?"ãƒ¡ãƒ¼ãƒ«ç¢ºèª":t==="signin"?"ãƒ­ã‚°ã‚¤ãƒ³":"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ",size:"md",children:e.jsxs("div",{className:"space-y-6",children:[f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-600",children:f})}),y==="verify"?e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[r.email," ã«ç¢ºèªã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚",e.jsx("br",{}),"ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚"]}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ç¢ºèªã‚³ãƒ¼ãƒ‰"}),e.jsx("input",{type:"text",name:"verificationCode",value:r.verificationCode,onChange:n,required:!0,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"123456"})]}),e.jsx(c,{type:"submit",variant:"primary",fullWidth:!0,loading:x,children:"ç¢ºèªã™ã‚‹"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[t==="signup"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ãŠåå‰"}),e.jsx("input",{type:"text",name:"fullName",value:r.fullName,onChange:n,required:!0,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"å±±ç”° å¤ªéƒ"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:n,required:!0,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"example@domain.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"}),e.jsx("input",{type:"password",name:"password",value:r.password,onChange:n,required:!0,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"8æ–‡å­—ä»¥ä¸Š"})]}),t==="signup"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª"}),e.jsx("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:n,required:!0,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",placeholder:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›"})]}),e.jsx(c,{type:"submit",variant:"primary",fullWidth:!0,loading:x,children:t==="signin"?"ãƒ­ã‚°ã‚¤ãƒ³":"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"ã¾ãŸã¯"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(c,{type:"button",variant:"outline",fullWidth:!0,onClick:()=>b("google"),icon:"ğŸŒ",children:"Googleã§ãƒ­ã‚°ã‚¤ãƒ³"}),e.jsx(c,{type:"button",variant:"outline",fullWidth:!0,onClick:()=>b("apple"),icon:"ğŸ",children:"Appleã§ãƒ­ã‚°ã‚¤ãƒ³"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:k,className:"text-sm text-primary-600 hover:text-primary-700",children:t==="signin"?"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„æ–¹ã¯ã“ã¡ã‚‰":"ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã®æ–¹ã¯ã“ã¡ã‚‰"})})]})]})})};export{M as L};
