{"version":3,"names":["cov_236bacze16","actualCoverage","sgMail","Queue","Redis","EventEmitter","ProductionEmailService","constructor","f","s","enabled","process","env","EMAIL_ENABLED","provider","b","EMAIL_PROVIDER","from","EMAIL_FROM","redisUrl","REDIS_URL","templates","initializeTemplates","queue","initialized","setupEmailProvider","setupQueue","setupSendGrid","setupAWSSES","Error","apiKey","SENDGRID_API_KEY","setApiKey","send","to","subject","text","mailSettings","sandboxMode","enable","console","log","error","message","region","AWS_REGION","accessKeyId","AWS_ACCESS_KEY_ID","secretAccessKey","AWS_SECRET_ACCESS_KEY","redisClient","createClient","url","connect","defaultJobOptions","attempts","backoff","type","delay","removeOnComplete","removeOnFail","settings","stalledInterval","maxStalledCount","processEmailJob","bind","on","job","id","emit","jobId","email","data","err","warn","emailData","templateData","sendEmailDirect","success","timestamp","Date","toISOString","html","renderTemplate","template","mailData","htmlToText","categories","customArgs","eventId","participantId","emailType","sendWithSES","sendEmail","options","simulated","jobData","add","priority","now","Math","random","toString","substr","queued","templateType","Object","keys","forEach","key","regex","RegExp","replace","trim","registrationConfirmation","speakerConfirmation","eventReminder","eventCancellation","feedbackRequest","sendBulkEmail","recipients","jobs","recipient","individualData","push","length","count","getQueueStats","waiting","active","completed","failed","Promise","all","getWaiting","getActive","getCompleted","getFailed","total","pauseQueue","pause","resumeQueue","resume","retryFailedJobs","retry","close","healthCheck","stats","status"],"sources":["email-production.js"],"sourcesContent":["/**\n * Production Email Service for Lightning Talk Event Management\n * Supports multiple providers (SendGrid, AWS SES) with queue system\n */\n\nimport sgMail from '@sendgrid/mail';\nimport Queue from 'bull';\nimport Redis from 'redis';\nimport { EventEmitter } from 'events';\n\nexport class ProductionEmailService extends EventEmitter {\n    constructor() {\n        super();\n        this.enabled = process.env.EMAIL_ENABLED !== 'false';\n        this.provider = process.env.EMAIL_PROVIDER || 'sendgrid';\n        this.from = process.env.EMAIL_FROM || 'noreply@lightningtalk.example.com';\n        this.redisUrl = process.env.REDIS_URL || 'redis://localhost:6379';\n        \n        this.templates = this.initializeTemplates();\n        this.queue = null;\n        this.initialized = false;\n        \n        if (this.enabled) {\n            this.setupEmailProvider();\n            this.setupQueue();\n        }\n    }\n\n    async setupEmailProvider() {\n        switch (this.provider) {\n            case 'sendgrid':\n                await this.setupSendGrid();\n                break;\n            case 'ses':\n                await this.setupAWSSES();\n                break;\n            default:\n                throw new Error(`Unsupported email provider: ${this.provider}`);\n        }\n    }\n\n    async setupSendGrid() {\n        const apiKey = process.env.SENDGRID_API_KEY;\n        if (!apiKey) {\n            throw new Error('SENDGRID_API_KEY is required for SendGrid provider');\n        }\n        \n        sgMail.setApiKey(apiKey);\n        \n        // Test API key validity\n        try {\n            await sgMail.send({\n                to: this.from,\n                from: this.from,\n                subject: 'API Test',\n                text: 'Test email',\n                mailSettings: {\n                    sandboxMode: {\n                        enable: true\n                    }\n                }\n            });\n            console.log('📧 SendGrid Email service initialized');\n        } catch (error) {\n            console.error('❌ SendGrid setup failed:', error.message);\n            throw error;\n        }\n    }\n\n    async setupAWSSES() {\n        // AWS SES implementation would go here\n        // For now, we'll prepare the structure\n        const region = process.env.AWS_REGION || 'us-east-1';\n        const accessKeyId = process.env.AWS_ACCESS_KEY_ID;\n        const secretAccessKey = process.env.AWS_SECRET_ACCESS_KEY;\n        \n        if (!accessKeyId || !secretAccessKey) {\n            throw new Error('AWS credentials are required for SES provider');\n        }\n        \n        console.log('📧 AWS SES Email service initialized');\n    }\n\n    async setupQueue() {\n        try {\n            // Create Redis connection for queue\n            const redisClient = Redis.createClient({\n                url: this.redisUrl\n            });\n            \n            await redisClient.connect();\n            \n            // Create email queue\n            this.queue = new Queue('email processing', this.redisUrl, {\n                defaultJobOptions: {\n                    attempts: 3,\n                    backoff: {\n                        type: 'exponential',\n                        delay: 2000,\n                    },\n                    removeOnComplete: 100,\n                    removeOnFail: 50,\n                },\n                settings: {\n                    stalledInterval: 30000,\n                    maxStalledCount: 1,\n                }\n            });\n\n            // Process email jobs\n            this.queue.process('send', this.processEmailJob.bind(this));\n            \n            // Queue event handlers\n            this.queue.on('completed', (job) => {\n                console.log(`📧 Email job ${job.id} completed`);\n                this.emit('emailSent', { jobId: job.id, email: job.data.to });\n            });\n\n            this.queue.on('failed', (job, err) => {\n                console.error(`❌ Email job ${job.id} failed:`, err.message);\n                this.emit('emailFailed', { jobId: job.id, email: job.data.to, error: err.message });\n            });\n\n            this.queue.on('stalled', (job) => {\n                console.warn(`⚠️ Email job ${job.id} stalled`);\n            });\n\n            console.log('🔄 Email queue system initialized');\n            this.initialized = true;\n            this.emit('ready');\n            \n        } catch (error) {\n            console.error('❌ Email queue setup failed:', error);\n            throw error;\n        }\n    }\n\n    async processEmailJob(job) {\n        const { emailData, templateData } = job.data;\n        \n        try {\n            await this.sendEmailDirect(emailData, templateData);\n            return { success: true, timestamp: new Date().toISOString() };\n        } catch (error) {\n            console.error('Email sending failed:', error);\n            throw error;\n        }\n    }\n\n    async sendEmailDirect(emailData, templateData = {}) {\n        const html = this.renderTemplate(emailData.template, templateData);\n        \n        const mailData = {\n            to: emailData.to,\n            from: emailData.from || this.from,\n            subject: emailData.subject,\n            text: this.htmlToText(html),\n            html: html,\n            categories: emailData.categories || ['lightning-talk'],\n            customArgs: {\n                eventId: templateData.eventId,\n                participantId: templateData.participantId,\n                emailType: emailData.template\n            }\n        };\n\n        switch (this.provider) {\n            case 'sendgrid':\n                return await sgMail.send(mailData);\n            case 'ses':\n                return await this.sendWithSES(mailData);\n            default:\n                throw new Error(`Unknown email provider: ${this.provider}`);\n        }\n    }\n\n    // Queue-based email sending (recommended for production)\n    async sendEmail(emailType, to, templateData = {}, options = {}) {\n        if (!this.enabled) {\n            console.log(`📧 [DISABLED] ${emailType} email to: ${to}`);\n            return { success: true, simulated: true };\n        }\n\n        const template = this.templates[emailType];\n        if (!template) {\n            throw new Error(`Unknown email template: ${emailType}`);\n        }\n\n        const jobData = {\n            emailData: {\n                to,\n                subject: template.subject,\n                template: emailType,\n                categories: [`lightning-talk-${emailType}`]\n            },\n            templateData\n        };\n\n        // Add to queue with priority and delay options\n        const job = await this.queue.add('send', jobData, {\n            priority: options.priority || 0,\n            delay: options.delay || 0,\n            attempts: options.attempts || 3,\n            jobId: options.jobId || `${emailType}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n        });\n\n        console.log(`📧 Email job queued: ${job.id} (${emailType} to ${to})`);\n        return { jobId: job.id, queued: true };\n    }\n\n    // Template rendering\n    renderTemplate(templateType, data) {\n        const template = this.templates[templateType];\n        if (!template) {\n            throw new Error(`Template not found: ${templateType}`);\n        }\n\n        let html = template.template;\n        \n        // Simple template variable replacement\n        Object.keys(data).forEach(key => {\n            const regex = new RegExp(`{{${key}}}`, 'g');\n            html = html.replace(regex, data[key] || '');\n        });\n\n        return html;\n    }\n\n    htmlToText(html) {\n        // Simple HTML to text conversion\n        return html\n            .replace(/<style[^>]*>.*?<\\/style>/gi, '')\n            .replace(/<script[^>]*>.*?<\\/script>/gi, '')\n            .replace(/<[^>]+>/g, '')\n            .replace(/\\s+/g, ' ')\n            .trim();\n    }\n\n    initializeTemplates() {\n        return {\n            registrationConfirmation: {\n                subject: '🎉 ライトニングトーク参加登録完了 - {{eventTitle}}',\n                template: `\n                    <!DOCTYPE html>\n                    <html>\n                    <head>\n                        <meta charset=\"UTF-8\">\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <title>参加登録完了</title>\n                        <style>\n                            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; }\n                            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                            .header { background: #4F46E5; color: white; padding: 20px; border-radius: 8px 8px 0 0; }\n                            .content { background: #F9FAFB; padding: 30px; border-radius: 0 0 8px 8px; }\n                            .button { background: #4F46E5; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 10px 0; }\n                            .info-box { background: white; padding: 20px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #4F46E5; }\n                            .footer { text-align: center; margin-top: 30px; color: #6B7280; font-size: 14px; }\n                        </style>\n                    </head>\n                    <body>\n                        <div class=\"container\">\n                            <div class=\"header\">\n                                <h1>🎉 参加登録完了</h1>\n                                <p>{{eventTitle}}への参加登録が完了しました！</p>\n                            </div>\n                            <div class=\"content\">\n                                <p>{{participantName}}様</p>\n                                <p>ライトニングトークイベントへのご参加、ありがとうございます。</p>\n                                \n                                <div class=\"info-box\">\n                                    <h3>📅 イベント詳細</h3>\n                                    <p><strong>日時:</strong> {{eventDate}}</p>\n                                    <p><strong>会場:</strong> {{eventVenue}}</p>\n                                    <p><strong>参加形式:</strong> {{participationType}}</p>\n                                    {{#if onlineUrl}}<p><strong>オンライン参加URL:</strong> <a href=\"{{onlineUrl}}\">{{onlineUrl}}</a></p>{{/if}}\n                                </div>\n\n                                <div class=\"info-box\">\n                                    <h3>📝 当日について</h3>\n                                    <ul>\n                                        <li>開場は開始時刻の30分前を予定しています</li>\n                                        <li>飲み物・軽食をご用意いたします</li>\n                                        <li>ネットワーキングタイムもございます</li>\n                                        <li>緊急連絡先: {{emergencyContact}}</li>\n                                    </ul>\n                                </div>\n\n                                <a href=\"{{eventUrl}}\" class=\"button\">イベント詳細を確認</a>\n                            </div>\n                            <div class=\"footer\">\n                                <p>Lightning Talk Circle<br>\n                                このメールに心当たりがない場合は、お手数ですが削除してください。</p>\n                            </div>\n                        </div>\n                    </body>\n                    </html>\n                `\n            },\n            speakerConfirmation: {\n                subject: '🎤 Lightning Talk発表申込み受付完了 - {{talkTitle}}',\n                template: `\n                    <!DOCTYPE html>\n                    <html>\n                    <head>\n                        <meta charset=\"UTF-8\">\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <title>発表申込み完了</title>\n                        <style>\n                            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; }\n                            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                            .header { background: #059669; color: white; padding: 20px; border-radius: 8px 8px 0 0; }\n                            .content { background: #F9FAFB; padding: 30px; border-radius: 0 0 8px 8px; }\n                            .button { background: #059669; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 10px 0; }\n                            .info-box { background: white; padding: 20px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #059669; }\n                            .footer { text-align: center; margin-top: 30px; color: #6B7280; font-size: 14px; }\n                        </style>\n                    </head>\n                    <body>\n                        <div class=\"container\">\n                            <div class=\"header\">\n                                <h1>🎤 発表申込み完了</h1>\n                                <p>Lightning Talk発表のお申込みを受付いたしました！</p>\n                            </div>\n                            <div class=\"content\">\n                                <p>{{speakerName}}様</p>\n                                <p>発表のお申込み、ありがとうございます。以下の内容で受付いたしました。</p>\n                                \n                                <div class=\"info-box\">\n                                    <h3>📋 発表内容</h3>\n                                    <p><strong>タイトル:</strong> {{talkTitle}}</p>\n                                    <p><strong>カテゴリ:</strong> {{talkCategory}}</p>\n                                    <p><strong>発表時間:</strong> {{talkDuration}}分</p>\n                                    <p><strong>概要:</strong></p>\n                                    <p>{{talkDescription}}</p>\n                                </div>\n\n                                <div class=\"info-box\">\n                                    <h3>🔧 発表準備について</h3>\n                                    <ul>\n                                        <li>スライドは事前に準備をお願いします</li>\n                                        <li>プロジェクター(HDMI)をご用意いたします</li>\n                                        <li>マイクは会場で準備いたします</li>\n                                        <li>リハーサルタイムがございます</li>\n                                    </ul>\n                                </div>\n\n                                <a href=\"{{speakerGuideUrl}}\" class=\"button\">発表者ガイドを確認</a>\n                            </div>\n                            <div class=\"footer\">\n                                <p>Lightning Talk Circle<br>\n                                ご不明な点がございましたら、お気軽にお問い合わせください。</p>\n                            </div>\n                        </div>\n                    </body>\n                    </html>\n                `\n            },\n            eventReminder: {\n                subject: '⚡ 明日開催！{{eventTitle}} - 開催リマインダー',\n                template: `\n                    <!DOCTYPE html>\n                    <html>\n                    <head>\n                        <meta charset=\"UTF-8\">\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <title>イベントリマインダー</title>\n                        <style>\n                            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; }\n                            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                            .header { background: #F59E0B; color: white; padding: 20px; border-radius: 8px 8px 0 0; }\n                            .content { background: #F9FAFB; padding: 30px; border-radius: 0 0 8px 8px; }\n                            .button { background: #F59E0B; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 10px 0; }\n                            .info-box { background: white; padding: 20px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #F59E0B; }\n                            .footer { text-align: center; margin-top: 30px; color: #6B7280; font-size: 14px; }\n                        </style>\n                    </head>\n                    <body>\n                        <div class=\"container\">\n                            <div class=\"header\">\n                                <h1>⚡ 明日開催!</h1>\n                                <p>{{eventTitle}}のリマインダーです</p>\n                            </div>\n                            <div class=\"content\">\n                                <p>{{participantName}}様</p>\n                                <p>いよいよ明日、Lightning Talkイベントの開催です！</p>\n                                \n                                <div class=\"info-box\">\n                                    <h3>📅 開催詳細（再掲）</h3>\n                                    <p><strong>日時:</strong> {{eventDate}}</p>\n                                    <p><strong>会場:</strong> {{eventVenue}}</p>\n                                    <p><strong>開場時刻:</strong> {{doorOpenTime}}</p>\n                                    {{#if onlineUrl}}<p><strong>オンライン参加URL:</strong> <a href=\"{{onlineUrl}}\">参加する</a></p>{{/if}}\n                                </div>\n\n                                <div class=\"info-box\">\n                                    <h3>📋 持ち物・注意事項</h3>\n                                    <ul>\n                                        <li>名刺（ネットワーキング用）</li>\n                                        <li>ノートパソコン（発表者の方）</li>\n                                        <li>会場は禁煙です</li>\n                                        <li>写真撮影を行う場合があります</li>\n                                    </ul>\n                                </div>\n\n                                <a href=\"{{eventUrl}}\" class=\"button\">最新情報を確認</a>\n                            </div>\n                            <div class=\"footer\">\n                                <p>Lightning Talk Circle<br>\n                                皆様にお会いできることを楽しみにしております！</p>\n                            </div>\n                        </div>\n                    </body>\n                    </html>\n                `\n            },\n            eventCancellation: {\n                subject: '⚠️ 【重要】{{eventTitle}} 中止のお知らせ',\n                template: `\n                    <!DOCTYPE html>\n                    <html>\n                    <head>\n                        <meta charset=\"UTF-8\">\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <title>イベント中止のお知らせ</title>\n                        <style>\n                            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; }\n                            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                            .header { background: #DC2626; color: white; padding: 20px; border-radius: 8px 8px 0 0; }\n                            .content { background: #F9FAFB; padding: 30px; border-radius: 0 0 8px 8px; }\n                            .info-box { background: white; padding: 20px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #DC2626; }\n                            .footer { text-align: center; margin-top: 30px; color: #6B7280; font-size: 14px; }\n                        </style>\n                    </head>\n                    <body>\n                        <div class=\"container\">\n                            <div class=\"header\">\n                                <h1>⚠️ イベント中止のお知らせ</h1>\n                                <p>{{eventTitle}}の中止についてご連絡いたします</p>\n                            </div>\n                            <div class=\"content\">\n                                <p>{{participantName}}様</p>\n                                <p>お申込みいただいておりました{{eventTitle}}ですが、やむを得ない事情により中止とさせていただくこととなりました。</p>\n                                \n                                <div class=\"info-box\">\n                                    <h3>📋 中止詳細</h3>\n                                    <p><strong>中止理由:</strong> {{cancellationReason}}</p>\n                                    <p><strong>次回開催予定:</strong> {{nextEventDate}}</p>\n                                </div>\n\n                                <p>ご参加を楽しみにしていただいていた皆様には、心よりお詫び申し上げます。</p>\n                                <p>次回の開催が決まりましたら、改めてご連絡させていただきます。</p>\n                            </div>\n                            <div class=\"footer\">\n                                <p>Lightning Talk Circle<br>\n                                ご不明な点がございましたら、お問い合わせください。</p>\n                            </div>\n                        </div>\n                    </body>\n                    </html>\n                `\n            },\n            feedbackRequest: {\n                subject: '💭 {{eventTitle}} 感想・フィードバックのお願い',\n                template: `\n                    <!DOCTYPE html>\n                    <html>\n                    <head>\n                        <meta charset=\"UTF-8\">\n                        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                        <title>フィードバックのお願い</title>\n                        <style>\n                            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; }\n                            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n                            .header { background: #7C3AED; color: white; padding: 20px; border-radius: 8px 8px 0 0; }\n                            .content { background: #F9FAFB; padding: 30px; border-radius: 0 0 8px 8px; }\n                            .button { background: #7C3AED; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 10px 0; }\n                            .info-box { background: white; padding: 20px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #7C3AED; }\n                            .footer { text-align: center; margin-top: 30px; color: #6B7280; font-size: 14px; }\n                        </style>\n                    </head>\n                    <body>\n                        <div class=\"container\">\n                            <div class=\"header\">\n                                <h1>💭 フィードバックのお願い</h1>\n                                <p>{{eventTitle}}へのご参加、ありがとうございました！</p>\n                            </div>\n                            <div class=\"content\">\n                                <p>{{participantName}}様</p>\n                                <p>先日開催いたしました{{eventTitle}}へのご参加、誠にありがとうございました。</p>\n                                \n                                <div class=\"info-box\">\n                                    <h3>📝 アンケートのお願い</h3>\n                                    <p>より良いイベント運営のため、ぜひ率直なご感想・ご意見をお聞かせください。</p>\n                                    <ul>\n                                        <li>所要時間: 約3分</li>\n                                        <li>匿名での回答も可能です</li>\n                                        <li>今後のイベント改善に活用いたします</li>\n                                    </ul>\n                                </div>\n\n                                <a href=\"{{feedbackUrl}}\" class=\"button\">アンケートに回答する</a>\n                                \n                                <div class=\"info-box\">\n                                    <h3>📅 次回開催について</h3>\n                                    <p>次回のLightning Talkイベントは{{nextEventDate}}を予定しております。</p>\n                                    <p>詳細が決まりましたら、改めてご案内いたします。</p>\n                                </div>\n                            </div>\n                            <div class=\"footer\">\n                                <p>Lightning Talk Circle<br>\n                                今後ともよろしくお願いいたします。</p>\n                            </div>\n                        </div>\n                    </body>\n                    </html>\n                `\n            }\n        };\n    }\n\n    // Bulk email operations\n    async sendBulkEmail(emailType, recipients, templateData = {}, options = {}) {\n        const jobs = [];\n        \n        for (const recipient of recipients) {\n            const individualData = { ...templateData, ...recipient };\n            const job = await this.sendEmail(emailType, recipient.email, individualData, {\n                ...options,\n                jobId: `bulk-${emailType}-${recipient.id || Date.now()}`\n            });\n            jobs.push(job);\n        }\n\n        console.log(`📧 Bulk email queued: ${jobs.length} emails (${emailType})`);\n        return { jobs, count: jobs.length };\n    }\n\n    // Queue management\n    async getQueueStats() {\n        if (!this.queue) return null;\n        \n        const [waiting, active, completed, failed] = await Promise.all([\n            this.queue.getWaiting(),\n            this.queue.getActive(),\n            this.queue.getCompleted(),\n            this.queue.getFailed()\n        ]);\n\n        return {\n            waiting: waiting.length,\n            active: active.length,\n            completed: completed.length,\n            failed: failed.length,\n            total: waiting.length + active.length + completed.length + failed.length\n        };\n    }\n\n    async pauseQueue() {\n        await this.queue.pause();\n        console.log('⏸️ Email queue paused');\n    }\n\n    async resumeQueue() {\n        await this.queue.resume();\n        console.log('▶️ Email queue resumed');\n    }\n\n    async retryFailedJobs() {\n        const failed = await this.queue.getFailed();\n        for (const job of failed) {\n            await job.retry();\n        }\n        console.log(`🔄 Retrying ${failed.length} failed email jobs`);\n    }\n\n    // Cleanup\n    async close() {\n        if (this.queue) {\n            await this.queue.close();\n            console.log('📧 Email service closed');\n        }\n    }\n\n    // Health check\n    async healthCheck() {\n        try {\n            const stats = await this.getQueueStats();\n            return {\n                status: 'healthy',\n                provider: this.provider,\n                enabled: this.enabled,\n                queue: stats,\n                timestamp: new Date().toISOString()\n            };\n        } catch (error) {\n            return {\n                status: 'unhealthy',\n                error: error.message,\n                timestamp: new Date().toISOString()\n            };\n        }\n    }\n}\n\nexport default ProductionEmailService;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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AC,CACzCA,OAAO,CAAC,8BAA8B,EAAE,EAAE,CAAC,CAC3CA,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CACvBA,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CACpBC,IAAI,CAAC,CAAC;EACf;EAEA3F,mBAAmBA,CAAA,EAAG;IAAA;IAAAtB,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAS,CAAA;IAClB,OAAO;MACHyG,wBAAwB,EAAE;QACtB/E,OAAO,EAAE,qCAAqC;QAC9CiD,QAAQ,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACY,CAAC;MACD+B,mBAAmB,EAAE;QACjBhF,OAAO,EAAE,4CAA4C;QACrDiD,QAAQ,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACY,CAAC;MACDgC,aAAa,EAAE;QACXjF,OAAO,EAAE,kCAAkC;QAC3CiD,QAAQ,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACY,CAAC;MACDiC,iBAAiB,EAAE;QACflF,OAAO,EAAE,+BAA+B;QACxCiD,QAAQ,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACY,CAAC;MACDkC,eAAe,EAAE;QACbnF,OAAO,EAAE,kCAAkC;QAC3CiD,QAAQ,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACY;IACJ,CAAC;EACL;;EAEA;EACA,MAAMmC,aAAaA,CAAC5B,SAAS,EAAE6B,UAAU,EAAE5C,YAAY;EAAA;EAAA,CAAA5E,cAAA,GAAAe,CAAA,WAAG,CAAC,CAAC,GAAE+E,OAAO;EAAA;EAAA,CAAA9F,cAAA,GAAAe,CAAA,WAAG,CAAC,CAAC,GAAE;IAAA;IAAAf,cAAA,GAAAQ,CAAA;IACxE,MAAMiH,IAAI;IAAA;IAAA,CAAAzH,cAAA,GAAAS,CAAA,QAAG,EAAE;IAAC;IAAAT,cAAA,GAAAS,CAAA;IAEhB,KAAK,MAAMiH,SAAS,IAAIF,UAAU,EAAE;MAChC,MAAMG,cAAc;MAAA;MAAA,CAAA3H,cAAA,GAAAS,CAAA,QAAG;QAAE,GAAGmE,YAAY;QAAE,GAAG8C;MAAU,CAAC;MACxD,MAAMvD,GAAG;MAAA;MAAA,CAAAnE,cAAA,GAAAS,CAAA,QAAG,MAAM,IAAI,CAACoF,SAAS,CAACF,SAAS,EAAE+B,S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","ignoreList":[]}