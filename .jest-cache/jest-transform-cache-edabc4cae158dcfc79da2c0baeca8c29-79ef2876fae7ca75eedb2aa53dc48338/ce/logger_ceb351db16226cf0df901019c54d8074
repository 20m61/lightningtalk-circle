58831467aec2ce0537075d5682dbab47
/**
 * Request logging middleware
 */

export const logger = (req, res, next) => {
  const start = Date.now();
  const timestamp = new Date().toISOString();

  // Log request
  console.log(`${timestamp} - ${req.method} ${req.originalUrl} - ${req.ip}`);

  // Override res.end to log response
  const originalEnd = res.end;
  res.end = function (chunk, encoding) {
    const duration = Date.now() - start;
    const size = res.get('Content-Length') || (chunk ? chunk.length : 0);
    console.log(`${timestamp} - ${req.method} ${req.originalUrl} - ${res.statusCode} - ${duration}ms - ${size}bytes`);
    originalEnd.call(res, chunk, encoding);
  };
  next();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXIiLCJyZXEiLCJyZXMiLCJuZXh0Iiwic3RhcnQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJjb25zb2xlIiwibG9nIiwibWV0aG9kIiwib3JpZ2luYWxVcmwiLCJpcCIsIm9yaWdpbmFsRW5kIiwiZW5kIiwiY2h1bmsiLCJlbmNvZGluZyIsImR1cmF0aW9uIiwic2l6ZSIsImdldCIsImxlbmd0aCIsInN0YXR1c0NvZGUiLCJjYWxsIl0sInNvdXJjZXMiOlsibG9nZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVxdWVzdCBsb2dnaW5nIG1pZGRsZXdhcmVcbiAqL1xuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuXG4gIC8vIExvZyByZXF1ZXN0XG4gIGNvbnNvbGUubG9nKGAke3RpbWVzdGFtcH0gLSAke3JlcS5tZXRob2R9ICR7cmVxLm9yaWdpbmFsVXJsfSAtICR7cmVxLmlwfWApO1xuXG4gIC8vIE92ZXJyaWRlIHJlcy5lbmQgdG8gbG9nIHJlc3BvbnNlXG4gIGNvbnN0IG9yaWdpbmFsRW5kID0gcmVzLmVuZDtcbiAgcmVzLmVuZCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHtcbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydDtcbiAgICBjb25zdCBzaXplID0gcmVzLmdldCgnQ29udGVudC1MZW5ndGgnKSB8fCAoY2h1bmsgPyBjaHVuay5sZW5ndGggOiAwKTtcblxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYCR7dGltZXN0YW1wfSAtICR7cmVxLm1ldGhvZH0gJHtyZXEub3JpZ2luYWxVcmx9IC0gJHtyZXMuc3RhdHVzQ29kZX0gLSAke2R1cmF0aW9ufW1zIC0gJHtzaXplfWJ5dGVzYFxuICAgICk7XG5cbiAgICBvcmlnaW5hbEVuZC5jYWxsKHJlcywgY2h1bmssIGVuY29kaW5nKTtcbiAgfTtcblxuICBuZXh0KCk7XG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUEsT0FBTyxNQUFNQSxNQUFNLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDeEMsTUFBTUMsS0FBSyxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0VBQ3hCLE1BQU1DLFNBQVMsR0FBRyxJQUFJRixJQUFJLENBQUMsQ0FBQyxDQUFDRyxXQUFXLENBQUMsQ0FBQzs7RUFFMUM7RUFDQUMsT0FBTyxDQUFDQyxHQUFHLENBQUMsR0FBR0gsU0FBUyxNQUFNTixHQUFHLENBQUNVLE1BQU0sSUFBSVYsR0FBRyxDQUFDVyxXQUFXLE1BQU1YLEdBQUcsQ0FBQ1ksRUFBRSxFQUFFLENBQUM7O0VBRTFFO0VBQ0EsTUFBTUMsV0FBVyxHQUFHWixHQUFHLENBQUNhLEdBQUc7RUFDM0JiLEdBQUcsQ0FBQ2EsR0FBRyxHQUFHLFVBQVVDLEtBQUssRUFBRUMsUUFBUSxFQUFFO0lBQ25DLE1BQU1DLFFBQVEsR0FBR2IsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxHQUFHRixLQUFLO0lBQ25DLE1BQU1lLElBQUksR0FBR2pCLEdBQUcsQ0FBQ2tCLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLSixLQUFLLEdBQUdBLEtBQUssQ0FBQ0ssTUFBTSxHQUFHLENBQUMsQ0FBQztJQUVwRVosT0FBTyxDQUFDQyxHQUFHLENBQ1QsR0FBR0gsU0FBUyxNQUFNTixHQUFHLENBQUNVLE1BQU0sSUFBSVYsR0FBRyxDQUFDVyxXQUFXLE1BQU1WLEdBQUcsQ0FBQ29CLFVBQVUsTUFBTUosUUFBUSxRQUFRQyxJQUFJLE9BQy9GLENBQUM7SUFFREwsV0FBVyxDQUFDUyxJQUFJLENBQUNyQixHQUFHLEVBQUVjLEtBQUssRUFBRUMsUUFBUSxDQUFDO0VBQ3hDLENBQUM7RUFFRGQsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDIiwiaWdub3JlTGlzdCI6W119