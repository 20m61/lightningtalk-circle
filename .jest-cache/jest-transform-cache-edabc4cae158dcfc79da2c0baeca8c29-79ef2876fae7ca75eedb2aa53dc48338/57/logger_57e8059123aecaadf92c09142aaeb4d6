c6f5435e1bbee8fa79995f0c2932e9c6
/**
 * Request logging middleware
 */

export const logger = (req, res, next) => {
  const start = Date.now();
  const timestamp = new Date().toISOString();

  // Log request
  console.log(`${timestamp} - ${req.method} ${req.originalUrl} - ${req.ip}`);

  // Override res.end to log response
  const originalEnd = res.end;
  res.end = function (chunk, encoding) {
    const duration = Date.now() - start;
    const size = res.get('Content-Length') || (chunk ? chunk.length : 0);
    console.log(`${timestamp} - ${req.method} ${req.originalUrl} - ${res.statusCode} - ${duration}ms - ${size}bytes`);
    originalEnd.call(res, chunk, encoding);
  };
  next();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXIiLCJyZXEiLCJyZXMiLCJuZXh0Iiwic3RhcnQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJjb25zb2xlIiwibG9nIiwibWV0aG9kIiwib3JpZ2luYWxVcmwiLCJpcCIsIm9yaWdpbmFsRW5kIiwiZW5kIiwiY2h1bmsiLCJlbmNvZGluZyIsImR1cmF0aW9uIiwic2l6ZSIsImdldCIsImxlbmd0aCIsInN0YXR1c0NvZGUiLCJjYWxsIl0sInNvdXJjZXMiOlsibG9nZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVxdWVzdCBsb2dnaW5nIG1pZGRsZXdhcmVcbiAqL1xuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBcbiAgICAvLyBMb2cgcmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKGAke3RpbWVzdGFtcH0gLSAke3JlcS5tZXRob2R9ICR7cmVxLm9yaWdpbmFsVXJsfSAtICR7cmVxLmlwfWApO1xuICAgIFxuICAgIC8vIE92ZXJyaWRlIHJlcy5lbmQgdG8gbG9nIHJlc3BvbnNlXG4gICAgY29uc3Qgb3JpZ2luYWxFbmQgPSByZXMuZW5kO1xuICAgIHJlcy5lbmQgPSBmdW5jdGlvbihjaHVuaywgZW5jb2RpbmcpIHtcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XG4gICAgICAgIGNvbnN0IHNpemUgPSByZXMuZ2V0KCdDb250ZW50LUxlbmd0aCcpIHx8IChjaHVuayA/IGNodW5rLmxlbmd0aCA6IDApO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYCR7dGltZXN0YW1wfSAtICR7cmVxLm1ldGhvZH0gJHtyZXEub3JpZ2luYWxVcmx9IC0gJHtyZXMuc3RhdHVzQ29kZX0gLSAke2R1cmF0aW9ufW1zIC0gJHtzaXplfWJ5dGVzYCk7XG4gICAgICAgIFxuICAgICAgICBvcmlnaW5hbEVuZC5jYWxsKHJlcywgY2h1bmssIGVuY29kaW5nKTtcbiAgICB9O1xuICAgIFxuICAgIG5leHQoKTtcbn07Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUEsT0FBTyxNQUFNQSxNQUFNLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDdEMsTUFBTUMsS0FBSyxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0VBQ3hCLE1BQU1DLFNBQVMsR0FBRyxJQUFJRixJQUFJLENBQUMsQ0FBQyxDQUFDRyxXQUFXLENBQUMsQ0FBQzs7RUFFMUM7RUFDQUMsT0FBTyxDQUFDQyxHQUFHLENBQUMsR0FBR0gsU0FBUyxNQUFNTixHQUFHLENBQUNVLE1BQU0sSUFBSVYsR0FBRyxDQUFDVyxXQUFXLE1BQU1YLEdBQUcsQ0FBQ1ksRUFBRSxFQUFFLENBQUM7O0VBRTFFO0VBQ0EsTUFBTUMsV0FBVyxHQUFHWixHQUFHLENBQUNhLEdBQUc7RUFDM0JiLEdBQUcsQ0FBQ2EsR0FBRyxHQUFHLFVBQVNDLEtBQUssRUFBRUMsUUFBUSxFQUFFO0lBQ2hDLE1BQU1DLFFBQVEsR0FBR2IsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxHQUFHRixLQUFLO0lBQ25DLE1BQU1lLElBQUksR0FBR2pCLEdBQUcsQ0FBQ2tCLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLSixLQUFLLEdBQUdBLEtBQUssQ0FBQ0ssTUFBTSxHQUFHLENBQUMsQ0FBQztJQUVwRVosT0FBTyxDQUFDQyxHQUFHLENBQUMsR0FBR0gsU0FBUyxNQUFNTixHQUFHLENBQUNVLE1BQU0sSUFBSVYsR0FBRyxDQUFDVyxXQUFXLE1BQU1WLEdBQUcsQ0FBQ29CLFVBQVUsTUFBTUosUUFBUSxRQUFRQyxJQUFJLE9BQU8sQ0FBQztJQUVqSEwsV0FBVyxDQUFDUyxJQUFJLENBQUNyQixHQUFHLEVBQUVjLEtBQUssRUFBRUMsUUFBUSxDQUFDO0VBQzFDLENBQUM7RUFFRGQsSUFBSSxDQUFDLENBQUM7QUFDVixDQUFDIiwiaWdub3JlTGlzdCI6W119